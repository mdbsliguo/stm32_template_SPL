---

<!-- 
注意：本文件的实际内容存储在 AI/rules/1_topics/examples.mdc
此文件为 Cursor IDE 的规则入口，内容与 AI/rules/1_topics/examples.mdc 同步
如需修改规则，请编辑 AI/rules/1_topics/examples.mdc，然后同步到此文件
-->

---
description: 案例创建规范 - 包含Examples目录下案例创建的所有规范，包括命名、目录结构、文件内容、初始化流程、文档规范等
alwaysApply: false
priority: medium
globs:
  - "Examples/**"
  - "Examples/**/*.c"
  - "Examples/**/*.h"
  - "Examples/**/*.md"
  - "Examples/**/*.uvprojx"
---

# 案例创建规范

**本文件包含Examples目录下案例创建的所有规范，优先级低于KEYWORDS.md和核心规则。**

---

## 1. 命名规范（强制）

### 1.1 分类目录命名
- **格式**：使用英文，首字母大写
- 示例：`I2C`、`LED`、`Delay`、`Basic`、`EXTI`、`UART`、`PWM`、`Timer`、`DMA`、`Bus`

### 1.2 案例目录命名
- **格式**：`分类名序号_中文描述`
- 序号：分类内从01开始自增
- 示例：
  - `I2C01_软件i2c示例`
  - `Basic03_blink`
  - `EXTI01_Infrared_Counter`
- **目录结构**：`Examples/xx/yy/`

### 1.3 工程文件命名
- 所有案例使用统一的工程文件名：`Examples.uvprojx`
- 输出文件名：`ExampleN`（N为案例编号，如 `Example01`、`Example02`）

---

## 2. 目录结构规范（强制）

### 2.1 案例目录结构
每个案例必须包含以下文件：

```
Examples/分类名/案例名/
├── Examples.uvprojx      # Keil工程文件（必须）
├── main_example.c         # 主程序入口（必须）
├── board.h               # 硬件配置文件（必须）
├── config.h              # 模块开关配置（必须）
└── README.md             # 案例说明文档（必须）
```

### 2.2 独立工程要求
- **每个案例都是独立的Keil工程，可以直接编译和运行**
- 无需复制到主工程
- 包含路径和模块配置都已独立配置
- 只包含本案例需要的模块源文件

---

## 3. 文件内容规范（强制）

### 3.1 工程文件（Examples.uvprojx）
- Keil工程文件，可直接打开编译
- 输出文件名：`ExampleN`（N为案例编号）
- 包含路径配置：
  - `..\..\..\Start`
  - `..\..\..\Library`
  - `..\..\..\Core`
  - `.`
  - `..\..\..\System`
  - `..\..\..\Debug`
  - `..\..\..\Common`
  - `..\..\..\Drivers\basic`
  - `..\..\..\Drivers\i2c`
  - `..\..\..\Drivers\spi`
  - `..\..\..\Drivers\display`
  - `..\..\..\Drivers\sensors`
  - `..\..\..\Drivers\uart`
  - `..\..\..\Drivers\dma`
  - `..\..\..\Drivers\peripheral`
  - `..\..\..\Drivers\timer`

### 3.2 主程序（main_example.c）
- 完整的、可编译的主程序代码
- 在独立工程中作为主文件使用
- 包含详细注释
- **必须遵循标准初始化流程**（见第5节）

### 3.3 硬件配置（board.h）
- 硬件配置文件
- **只包含本案例需要的配置**
- 从主工程的 `BSP/board.h` 复制相关配置
- 配置必须与硬件连接一致

### 3.4 模块配置（config.h）
- 模块开关配置
- **只启用本案例需要的模块**
- 从主工程的 `System/config.h` 复制相关配置
- 使用 `CONFIG_MODULE_XXX_ENABLED` 宏控制

---

## 4. 标准初始化流程（强制）

### 4.1 初始化顺序
所有案例的 `main_example.c` 必须遵循以下初始化顺序：

```c
int main(void) {
    // 1. 系统初始化（必须）
    System_Init();
    
    // 2. UART初始化（如果使用UART）
    error_code_t result = UART_Init();
    if (result != ERROR_OK) {
        ErrorHandler_Report(result, __FILE__, __LINE__);
        return -1;
    }
    
    // 3. Debug初始化（如果使用Debug）
    result = Debug_Init();
    if (result != ERROR_OK) {
        ErrorHandler_Report(result, __FILE__, __LINE__);
        return -1;
    }
    
    // 4. Log初始化（如果使用Log）
    result = Log_Init();
    if (result != ERROR_OK) {
        ErrorHandler_Report(result, __FILE__, __LINE__);
        return -1;
    }
    
    // 5. ErrorHandler初始化（如果使用ErrorHandler）
    result = ErrorHandler_Init();
    if (result != ERROR_OK) {
        ErrorHandler_Report(result, __FILE__, __LINE__);
        return -1;
    }
    
    // 6. 其他模块初始化（按需）
    // ...
    
    // 主循环
    while(1) {
        // 案例功能代码
    }
}
```

### 4.2 初始化要求
- `System_Init()` 必须在 main() 开始调用
- 其他模块依赖系统初始化，不要跳过
- 所有初始化函数必须检查错误码
- 初始化失败必须报告错误并返回

---

## 5. README文档规范（强制）

### 5.1 必须包含的内容
每个案例的 `README.md` 必须包含以下章节：

1. **功能说明**
   - 案例的功能描述
   - 实现的功能点

2. **硬件要求**
   - 需要的硬件设备
   - 硬件连接方式
   - 引脚配置说明

3. **使用方法**
   - 打开独立工程编译运行
   - 编译步骤（F7）
   - 下载步骤（F8）

4. **代码说明**
   - 关键代码解释
   - 实现原理

5. **扩展练习**
   - 可选的扩展功能
   - 进阶练习建议

6. **功能限制说明**（如果使用了空函数，必须说明）
   - 明确说明哪些功能使用了占位空函数
   - 说明空函数的限制

7. **标准初始化流程**
   - 说明本案例遵循的标准初始化流程

### 5.2 文档格式要求
- 使用UTF-8编码
- 使用Markdown格式
- 标题层级：`# → ## → ###`
- 必须结构化、可扫描
- 包含必要的代码示例

---

## 6. 空函数检查规范（强制）

### 6.1 检查要求
**创建案例时必须检查**：案例中使用的模块函数是否为**占位空函数**。

### 6.2 空函数识别
- 检查模块函数实现是否为空函数（只返回 `ERROR_OK`，无实际功能）
- 检查模块是否在 `System/config.h` 中被禁用
- 检查模块是否未完整实现

### 6.3 处理方式
- 如果使用了空函数，必须在 `README.md` 中明确说明
- 说明空函数的限制和影响
- 说明如何启用完整功能（如果需要）

---

## 7. 代码规范（强制）

### 7.1 错误处理
- 所有函数调用必须检查错误码
- 使用 `ErrorHandler_Report()` 报告错误
- 错误处理要及时，不要忽略错误码

### 7.2 参数校验
- 调用模块函数前必须进行参数校验
- 使用配置表而非硬编码
- 硬件配置必须从 `board.h` 读取

### 7.3 代码注释
- 关键代码必须包含注释
- 注释要清晰、准确
- 复杂逻辑必须说明实现原理

---

## 8. 测试要求（强制）

### 8.1 编译测试
- 案例必须能够编译通过（0 Error, 0 Warning）
- 编译输出文件名：`ExampleN`

### 8.2 功能测试
- 案例必须能够正常运行
- 功能必须符合预期
- 硬件必须按预期工作

### 8.3 文档测试
- README文档必须准确描述案例功能
- 硬件要求必须与实际一致
- 使用方法必须可执行

---

## 9. 案例分类规范

### 9.1 分类原则
- 按模块功能分类
- 相同功能的案例放在同一目录下
- 每个分类独立目录

### 9.2 常见分类
- **Basic**：基础功能相关案例（LED、GPIO、按键等）
- **I2C**：I2C通信相关案例
- **UART**：串口通信相关案例
- **SPI**：SPI通信相关案例
- **PWM**：PWM相关案例
- **Timer**：定时器相关案例
- **EXTI**：外部中断相关案例
- **ADC**：ADC相关案例
- **DMA**：DMA相关案例
- **Bus**：总线通信相关案例（ModBus等）
- **Delay**：延时相关案例
- **ClockManager**：时钟管理相关案例
- **OLED**：OLED显示相关案例
- **RTC**：RTC实时时钟相关案例
- **传感器类**：各种传感器相关案例（如 `MAX31856`）

---

## 10. 案例创建流程

### 10.1 创建步骤
1. **确定分类**：确定案例所属分类
2. **创建目录**：在 `Examples/分类名/` 下创建案例目录
3. **命名规范**：按照命名规范命名目录
4. **创建工程**：创建 `Examples.uvprojx` 工程文件
5. **编写代码**：编写 `main_example.c` 主程序
6. **配置硬件**：创建 `board.h` 硬件配置文件
7. **配置模块**：创建 `config.h` 模块开关配置
8. **编写文档**：编写 `README.md` 说明文档
9. **测试验证**：编译测试、功能测试、文档测试
10. **空函数检查**：检查是否使用了空函数，并在文档中说明

### 10.2 验证清单
创建案例后，必须验证以下内容：
- [ ] 目录命名符合规范
- [ ] 工程文件可以正常打开和编译
- [ ] 主程序遵循标准初始化流程
- [ ] 硬件配置与实际一致
- [ ] 模块配置只启用需要的模块
- [ ] README文档包含所有必需章节
- [ ] 空函数检查完成并在文档中说明
- [ ] 代码编译通过（0 Error, 0 Warning）
- [ ] 功能测试通过
- [ ] 文档测试通过

---

**最后更新**：2024-12-19
