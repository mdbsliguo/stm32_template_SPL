#include "key.h"                  // Device header
#include "Delay.h"

uint8_t KeyNum=0;

/*******************************************************************************  
*
* å‡?æ•?å? void Key_Init(void)
* åŠŸèƒ½æè¿°: PA0--KEY1  PA1--KEY2 æŒ‰é”®åˆå§‹åŒ?
* å‡½æ•°è¯´æ˜Ž: 
* è°ƒç”¨å‡½æ•°: 
* å…¨å±€å˜é‡: 
* è¾?   å…? æ—?
* è¿?   å›? 
* è®?è®?è€…ï¼šPirate1865               æ—¥æœŸï¼?0240319
* ä¿?æ”?è€…ï¼š                         æ—¥æœŸï¼?
* ç‰?   æœ¬ï¼š
*
********************************************************************************/
void Key_Init(void)
{

	RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, ENABLE);		//å¼€å¯GPIOAçš„æ—¶é’?
	
	
	GPIO_InitTypeDef GPIO_InitStructure;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0 | GPIO_Pin_1;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);						//å°†PA0å’ŒPA1å¼•è„šåˆå§‹åŒ–ä¸ºä¸Šæ‹‰è¾“å…¥
}



/*******************************************************************************  
*
* å‡?æ•?å? uint8_t Key_GetNum(void)
* åŠŸèƒ½æè¿°: æŒ‰é”®èŽ·å–é”®ç 
* å‡½æ•°è¯´æ˜Ž: æ­¤å‡½æ•°æ˜¯é˜»å¡žå¼æ“ä½œï¼Œå½“æŒ‰é”®æŒ‰ä½ä¸æ”¾æ—¶ï¼Œå‡½æ•°ä¼šå¡ä½ï¼Œç›´åˆ°æŒ‰é”®æ¾æ‰?
* è°ƒç”¨å‡½æ•°: 
* å…¨å±€å˜é‡: 
* è¾?   å…? æ—?
* è¿?   å›? æŒ‰ä¸‹æŒ‰é”®çš„é”®ç å€¼ï¼ŒèŒƒå›´ï¼?~2ï¼Œè¿”å›?ä»£è¡¨æ²¡æœ‰æŒ‰é”®æŒ‰ä¸‹
* è®?è®?è€…ï¼šPirate1865               æ—¥æœŸï¼?0240319
* ä¿?æ”?è€…ï¼š                         æ—¥æœŸï¼?
* ç‰?   æœ¬ï¼š
*
********************************************************************************/
void Key_GetNum(void)
{
	
	if (GPIO_ReadInputDataBit(GPIOA, GPIO_Pin_0) == 0)			//è¯»PA0è¾“å…¥å¯„å­˜å™¨çš„çŠ¶æ€ï¼Œå¦‚æžœä¸?ï¼Œåˆ™ä»£è¡¨æŒ‰é”®1æŒ‰ä¸‹
	{
		Delay_ms(20);											//å»¶æ—¶æ¶ˆæŠ–
		while (GPIO_ReadInputDataBit(GPIOA, GPIO_Pin_0) == 0);	//ç­‰å¾…æŒ‰é”®æ¾æ‰‹
		Delay_ms(20);											//å»¶æ—¶æ¶ˆæŠ–
		KeyNum ++;												//é”®å€¼åŠ 1
		if(KeyNum>=4)                     //é”®å€¼å¢žåŠ åˆ°4æ—¶ï¼Œå¼ºåˆ¶é”®å€¼ä¸º1
		{
			KeyNum=1;
		}
	}
}
